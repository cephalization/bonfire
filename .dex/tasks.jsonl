{"id":"1wgbromu","parent_id":"oiub445r","name":"Configure Tailwind CSS and shadcn/ui","description":"Set up Tailwind CSS and initialize shadcn/ui component library.\n\n**Root Plan Reference**: See PLAN.md section 'Web UI Pages & Components'.\n\n**Fetch Docs Before Starting**:\n- Tailwind with Vite: https://tailwindcss.com/docs/guides/vite\n- shadcn/ui installation: https://ui.shadcn.com/docs/installation/vite\n\n**Implementation**:\n1. Install and configure Tailwind CSS\n2. Run `bunx shadcn@latest init` to set up shadcn\n3. Configure components.json for the project\n4. Add base shadcn components needed throughout:\n   - Button, Card, Dialog, Input, Label\n   - Dropdown, Badge, Separator\n   - Drawer (for mobile modals)\n5. Set up CSS variables for theming\n\n**Verification**:\n- Tailwind classes work in components\n- shadcn components render correctly\n- Can add new components with `bunx shadcn@latest add <name>`\n\n**Tests**: None (styling/config)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:36.062Z","updated_at":"2026-01-30T03:51:35.226Z","started_at":null,"completed_at":null,"blockedBy":["6yvex719"],"blocks":["kgm3jsw5"],"children":[]}
{"id":"2ogyez16","parent_id":null,"name":"Phase 3: Agent Communication","description":"Parent task for guest agent communication. Implements the Agent service that proxies requests to Slicer's agent running inside VMs.\n\n**Root Plan Reference**: See PLAN.md sections:\n- Services Implementation (Agent Service)\n- API Endpoints (health, exec, cp, terminal WebSocket)\n\n**Prerequisites**: Phase 2 must be complete (VMs can be started).\n\n**Completion Criteria**: All subtasks complete - can check VM health, execute commands, copy files, and connect terminal via WebSocket.","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:49:28.822Z","updated_at":"2026-01-30T03:50:09.240Z","started_at":null,"completed_at":null,"blockedBy":["vqokg46b"],"blocks":["jgyl8pew"],"children":["o50py7s5","k0evvytc","i6bpqkir","uip4muxr","64tnrqyj"]}
{"id":"30peita1","parent_id":"epo976bv","name":"Generate TypeScript SDK from OpenAPI","description":"Create the SDK generation script and generate the SDK package.\n\n**Root Plan Reference**: See PLAN.md sections 'SDK package' and 'Scripts (generate-sdk.ts)'.\n\n**Implementation**:\nCreate scripts/generate-sdk.ts:\n1. Fetch OpenAPI spec from running API or file\n2. Use openapi-typescript-codegen or similar to generate client\n3. Output to packages/sdk/src/\n4. Generate:\n   - client.ts - BonfireClient class\n   - types.ts - All TypeScript types\n   - index.ts - Exports\n\nUpdate packages/sdk/package.json:\n- Add generate script\n- Set up proper exports\n\n**Verification**:\n- `bun run generate` creates SDK files\n- SDK compiles without errors\n- Types match API spec\n\n**Tests**: Type tests that SDK types are correct","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:21.780Z","updated_at":"2026-01-30T03:52:51.616Z","started_at":null,"completed_at":null,"blockedBy":["8y8f9afg","kx70pb7q"],"blocks":["718lsccm","ssq7067i"],"children":[]}
{"id":"64tnrqyj","parent_id":"2ogyez16","name":"Implement WebSocket terminal proxy","description":"Implement the WebSocket endpoint for terminal access to VMs.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - VMs' (WS /api/vms/:id/terminal).\n\n**Fetch Docs Before Starting**:\n- Hono WebSocket: https://hono.dev/docs/helpers/websocket\n- Slicer shell API: https://docs.slicervm.com/reference/api\n\n**Implementation**:\nCreate packages/api/src/routes/terminal.ts:\n\nWS /api/vms/:id/terminal:\n1. Upgrade to WebSocket\n2. Get VM from DB, verify running\n3. Connect to agent's shell endpoint (likely WebSocket or TTY stream)\n4. Bidirectional proxy:\n   - Client -> Agent: forward keystrokes/input\n   - Agent -> Client: forward output\n5. Handle resize events (if agent supports)\n6. Clean up on disconnect\n\nCreate packages/api/src/services/agent/shell.ts:\n- getShellStream(vmIp): Returns duplex stream to agent shell\n\n**Verification**:\n- WebSocket connects successfully\n- Input/output flows both directions\n- Connection closes cleanly\n\n**Tests**: Unit tests for message formatting, integration tests with mock WebSocket","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:03.286Z","updated_at":"2026-01-30T03:50:10.799Z","started_at":null,"completed_at":null,"blockedBy":["o50py7s5"],"blocks":["fjb9xwa6"],"children":[]}
{"id":"6yvex719","parent_id":"oiub445r","name":"Initialize React + Vite app","description":"Set up the React application with Vite in the web package.\n\n**Root Plan Reference**: See PLAN.md section 'Monorepo Structure' (packages/web).\n\n**Fetch Docs Before Starting**:\n- Vite React: https://vite.dev/guide/\n\n**Implementation**:\n1. Initialize Vite React-TS project in packages/web\n2. Configure vite.config.ts:\n   - Dev server port 5173\n   - API proxy to localhost:3000\n3. Create basic App.tsx with routing setup (react-router-dom)\n4. Add index.html with mobile viewport meta tag\n5. Update package.json scripts (dev, build, preview)\n\n**Verification**:\n- `bun run dev` starts Vite dev server\n- App loads in browser at localhost:5173\n- HMR works\n\n**Tests**: None (scaffolding)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:28.750Z","updated_at":"2026-01-30T03:51:34.931Z","started_at":null,"completed_at":null,"blockedBy":["t45jd3oh"],"blocks":["1wgbromu","t6hjkcj3"],"children":[]}
{"id":"718lsccm","parent_id":"epo976bv","name":"Implement CLI - core structure and config","description":"Set up the CLI package with Clack and configuration management.\n\n**Root Plan Reference**: See PLAN.md section 'CLI Commands'.\n\n**Fetch Docs Before Starting**:\n- Clack: https://github.com/bombshell-dev/clack\n\n**Implementation**:\nCreate packages/cli/src/index.ts:\n1. Parse arguments using Clack or yargs\n2. Set up command structure: vm, image, config, login\n3. Global options: --api-url, --config\n\nCreate packages/cli/src/lib/config.ts:\n1. Load config from ~/.bonfire/config.json\n2. Save config to ~/.bonfire/config.json\n3. Config schema: { apiUrl, token }\n\nCreate packages/cli/src/lib/client.ts:\n1. Import and wrap @bonfire/sdk\n2. Configure with auth from config\n\nAdd bin field to package.json for 'bonfire' command.\n\n**Verification**:\n- `bonfire --help` shows usage\n- `bonfire config set api-url http://localhost:3000` works\n- Config persists across runs\n\n**Tests**: Unit tests for config loading/saving","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:29.743Z","updated_at":"2026-01-30T03:52:55.290Z","started_at":null,"completed_at":null,"blockedBy":["30peita1"],"blocks":["dnihkrz1","wjdenygd"],"children":[]}
{"id":"8umd2ulb","parent_id":"vqokg46b","name":"Create test utilities and mock factories","description":"Create test infrastructure for integration tests.\n\n**Root Plan Reference**: See PLAN.md section 'Testing Strategy' - Test utilities section.\n\n**Implementation**:\nCreate packages/api/src/test-utils.ts:\n1. createTestApp(): Creates Hono app with fresh temp SQLite DB\n   - Creates /tmp/bonfire-test-{uuid}.db\n   - Runs migrations\n   - Injects mocked Firecracker and Network services\n   - Returns { app, db, request, cleanup }\n2. createMockFirecrackerService(): Returns mock with jest.fn() equivalents\n3. createMockNetworkService(): Returns mock with IP allocation tracking\n\nThis enables fast, isolated integration tests that don't need real VMs.\n\n**Verification**:\n- createTestApp() creates working test harness\n- Mocks record calls for assertions\n- Cleanup removes temp database\n\n**Tests**: Meta-test that test utilities work correctly","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:49:04.707Z","updated_at":"2026-01-30T03:49:16.334Z","started_at":null,"completed_at":null,"blockedBy":["tq3nqjx2","u9wc8vey"],"blocks":["w56hku3s"],"children":[]}
{"id":"8y8f9afg","parent_id":"lv52wsii","name":"Add OpenAPI spec generation for SDK","description":"Set up automatic OpenAPI specification generation from the Hono API for future SDK generation.\n\n**Root Plan Reference**: See PLAN.md section 'Scripts' (scripts/generate-sdk.ts) and 'Implementation Phases' Phase 1.\n\n**Implementation**:\n1. Install @hono/zod-openapi in packages/api\n2. Refactor routes to use OpenAPI-compatible route definitions with Zod schemas\n3. Add /api/openapi.json endpoint that serves the generated spec\n4. Create scripts/generate-sdk.ts placeholder (actual generation in Phase 5)\n\n**Fetch Docs Before Starting**:\n- Hono OpenAPI: https://hono.dev/examples/zod-openapi\n\n**Verification**:\n- GET /api/openapi.json returns valid OpenAPI 3.0 spec\n- Spec includes health endpoint definition\n- Zod schemas validate request/response\n\n**Tests**:\n- Unit test that OpenAPI spec is valid JSON\n- Validate spec structure has required fields","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:47:37.687Z","updated_at":"2026-01-30T03:47:49.956Z","started_at":null,"completed_at":null,"blockedBy":["u9wc8vey"],"blocks":["m728c9xj","kx70pb7q","30peita1"],"children":[]}
{"id":"byyhjd7g","parent_id":"vqokg46b","name":"Implement Network service - TAP device management","description":"Create the network service's TAP device and bridge management (system calls).\n\n**Root Plan Reference**: See PLAN.md section 'Network Service' and 'Setup Script'.\n\n**Implementation**:\nCreate packages/api/src/services/network/tap.ts:\n1. createTap(vmId): Creates TAP device, attaches to bridge bonfire0\n2. deleteTap(tapName): Removes TAP device\n3. Uses child_process to run ip commands\n\nCreate packages/api/src/services/network/index.ts:\n- Export combined NetworkService with IP pool + TAP management\n- Dependency inject IPPool for testability\n\n**Note**: These functions require root/NET_ADMIN capability. Integration tests only.\n\n**Verification**:\n- TypeScript compiles\n- Functions have proper error handling for permission denied\n\n**Tests**: \n- Unit tests mock child_process (packages/api/src/services/network/tap.test.ts)\n- Integration tests in docker container","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:18.026Z","updated_at":"2026-01-30T03:49:10.526Z","started_at":null,"completed_at":null,"blockedBy":["t44hfjxh"],"blocks":["nuaw58y3"],"children":[]}
{"id":"dnihkrz1","parent_id":"epo976bv","name":"Implement CLI - VM commands","description":"Implement the VM management commands for the CLI.\n\n**Root Plan Reference**: See PLAN.md section 'CLI Commands - vm subcommands'.\n\n**Implementation**:\nCreate packages/cli/src/commands/vm.ts:\n\nbonfire vm create <name> [options]:\n- Options: --vcpus, --memory, --image\n- Use Clack spinner for creation\n- Print created VM details\n\nbonfire vm list:\n- Table output of all VMs\n- Columns: ID, Name, Status, IP, vCPUs, Memory\n\nbonfire vm start <name|id>:\n- Start VM, show spinner\n- Print success message with IP\n\nbonfire vm stop <name|id>:\n- Stop VM, show spinner\n- Print success message\n\nbonfire vm rm <name|id>:\n- Confirm deletion (Clack confirm)\n- Delete VM\n\nbonfire vm exec <name|id> -- <command...>:\n- Execute command, print stdout/stderr\n- Exit with command's exit code\n\nbonfire vm ssh <name|id>:\n- Open interactive shell (connect to terminal WebSocket)\n\n**Verification**:\n- All commands work with running API\n- Output is formatted nicely\n- Errors are user-friendly\n\n**Tests**: Unit tests for argument parsing","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:38.202Z","updated_at":"2026-01-30T03:52:55.566Z","started_at":null,"completed_at":null,"blockedBy":["718lsccm"],"blocks":[],"children":[]}
{"id":"epo976bv","parent_id":null,"name":"Phase 5: Images, SDK & CLI","description":"Parent task for OCI image registry, SDK generation, and CLI implementation.\n\n**Root Plan Reference**: See PLAN.md sections:\n- Services Implementation (Registry Service)\n- API Endpoints (Images)\n- CLI Commands\n- Scripts (generate-sdk.ts)\n\n**Prerequisites**: Phase 1 complete (for OpenAPI), Phase 2 complete (for image references in VMs).\n\n**Completion Criteria**: All subtasks complete - can pull OCI images, SDK is generated and usable, CLI works for all operations.","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:00.949Z","updated_at":"2026-01-30T03:52:50.120Z","started_at":null,"completed_at":null,"blockedBy":["lv52wsii"],"blocks":["jgyl8pew"],"children":["rug8l1do","kx70pb7q","30peita1","718lsccm","dnihkrz1","wjdenygd"]}
{"id":"f2ezlz9s","parent_id":"vqokg46b","name":"Implement Firecracker service - config generation","description":"Create Firecracker configuration generation (pure functions).\n\n**Root Plan Reference**: See PLAN.md section 'Firecracker Service'.\n\n**Fetch Docs Before Starting**:\n- Firecracker API spec: https://github.com/firecracker-microvm/firecracker/blob/main/src/firecracker/swagger/firecracker.yaml\n\n**Implementation**:\nCreate packages/api/src/services/firecracker/config.ts:\n1. generateMachineConfig({ vcpus, memoryMib }): Returns Firecracker machine-config payload\n2. generateBootSource({ kernelPath, bootArgs }): Returns boot-source payload\n3. generateDrive({ driveId, pathOnHost, isRootDevice }): Returns drive payload\n4. generateNetworkInterface({ tapDevice, macAddress }): Returns network-interface payload\n\n**Why separate**: Pure config generation can be fully unit tested.\n\n**Verification**:\n- Generated configs match Firecracker API spec structure\n- All required fields present\n\n**Tests**: Unit tests (packages/api/src/services/firecracker/config.test.ts)\n- Each generator produces valid structure\n- Default values applied correctly","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:25.243Z","updated_at":"2026-01-30T03:54:46.992Z","started_at":null,"completed_at":null,"blockedBy":["t45jd3oh"],"blocks":["t2qv6cbk"],"children":[]}
{"id":"fjb9xwa6","parent_id":"oiub445r","name":"Implement VM Detail page with terminal","description":"Create the VM detail page with full terminal access.\n\n**Root Plan Reference**: See PLAN.md sections 'Pages - VM Detail' and 'Components - Terminal.tsx'.\n\n**Fetch Docs Before Starting**:\n- ghostty-web: https://github.com/coder/ghostty-web\n- PartySocket React: https://github.com/cloudflare/partykit/tree/main/packages/partysocket\n\n**Implementation**:\nCreate packages/web/src/pages/VMDetail.tsx:\n1. Header with VM name, status badge, IP address\n2. Action buttons: Start/Stop, Delete\n3. Terminal component (full height below header)\n\nCreate packages/web/src/components/Terminal.tsx:\n1. Wrapper for ghostty-web terminal emulator\n2. WebSocket connection via PartySocket's useWebSocket hook\n3. Connect to /api/vms/:id/terminal\n4. Auto-reconnection on network changes (critical for mobile)\n5. Handle resize events\n6. Message buffering during brief disconnects\n\n**Mobile**:\n- Actions above terminal in horizontal scroll\n- Terminal fills remaining viewport height\n- Appropriate font size for mobile\n\n**Verification**:\n- Terminal connects and displays output\n- Typing sends input to VM\n- Reconnects on network drop\n- Resize works\n\n**Tests**: Component tests for Terminal mounting/unmounting","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:51:15.189Z","updated_at":"2026-01-30T03:51:45.937Z","started_at":null,"completed_at":null,"blockedBy":["g32ltrky","64tnrqyj"],"blocks":[],"children":[]}
{"id":"g32ltrky","parent_id":"oiub445r","name":"Implement Dashboard with VM list","description":"Create the main dashboard showing all VMs.\n\n**Root Plan Reference**: See PLAN.md section 'Pages - Dashboard' and 'Components - VMList, VMCard'.\n\n**Skills to Load**:\n- vercel-react-best-practices\n\n**Implementation**:\nCreate packages/web/src/pages/Dashboard.tsx:\n1. Fetch VMs from API on mount\n2. \"Create VM\" button in header\n3. Display VMList component\n4. Handle loading and error states\n\nCreate packages/web/src/components/VMList.tsx:\n1. Grid of VMCard components\n2. Responsive: 1 column mobile, 2 tablet, 3 desktop\n3. Empty state when no VMs\n\nCreate packages/web/src/components/VMCard.tsx:\n1. Card showing: name, status badge, IP (if running), specs\n2. Status colors: running=green, stopped=gray, creating=yellow, error=red\n3. Quick action buttons: Start/Stop, Delete, Open Terminal\n4. Click card to go to detail page\n\n**Mobile**: Cards stack vertically, actions accessible.\n\n**Verification**:\n- VMs display correctly\n- Status badges show correct colors\n- Actions work\n\n**Tests**: Component tests for VMCard rendering different states","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:59.048Z","updated_at":"2026-01-30T03:51:41.477Z","started_at":null,"completed_at":null,"blockedBy":["kgm3jsw5","t6hjkcj3"],"blocks":["kzmbplbq","fjb9xwa6"],"children":[]}
{"id":"godpn1v3","parent_id":"oiub445r","name":"Implement Login page","description":"Create the login page with Better Auth integration.\n\n**Root Plan Reference**: See PLAN.md section 'Pages - Login'.\n\n**Fetch Docs Before Starting**:\n- Better Auth React: https://www.better-auth.com/docs/client/react\n\n**Implementation**:\nCreate packages/web/src/pages/Login.tsx:\n1. Email/password form using shadcn Input, Label, Button\n2. Form validation (required fields, email format)\n3. Submit handler that calls Better Auth sign-in\n4. Error handling and display\n5. Redirect to dashboard on success\n6. Link to sign-up flow\n\nCreate packages/web/src/lib/auth.ts:\n- Initialize Better Auth client\n- Export useSession hook\n\n**Mobile**: Form should be centered, full-width inputs on mobile.\n\n**Verification**:\n- Form renders correctly\n- Validation prevents bad submissions\n- Successful login redirects to /\n- Failed login shows error\n\n**Tests**: Component tests for form validation","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:51.523Z","updated_at":"2026-01-30T03:51:40.889Z","started_at":null,"completed_at":null,"blockedBy":["kgm3jsw5","t6hjkcj3","mt1g0hdi"],"blocks":[],"children":[]}
{"id":"hbbcj14o","parent_id":"lv52wsii","name":"Initialize Bun monorepo with workspaces","description":"Set up the Bun workspace monorepo structure.\n\n**Root Plan Reference**: See PLAN.md section 'Monorepo Structure' for the full directory layout.\n\n**Implementation**:\n1. Create root package.json with workspaces config pointing to packages/*\n2. Create packages/ directory with subdirectories: api, web, sdk, cli\n3. Initialize each package with its own package.json\n4. Set up shared tsconfig.json at root\n\n**Fetch Docs Before Starting**:\n- Bun workspaces: https://bun.sh/docs/install/workspaces\n\n**Verification**:\n- `bun install` runs successfully at root\n- Each package directory exists with package.json\n- Workspace dependencies resolve correctly\n\n**Tests**: None required (scaffolding only)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:46:54.612Z","updated_at":"2026-01-30T03:46:54.612Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":["ts9kuutu","t45jd3oh","mpkto56o"],"children":[]}
{"id":"i0sygiuz","parent_id":"oiub445r","name":"Implement Images page","description":"Create the images management page.\n\n**Root Plan Reference**: See PLAN.md section 'Pages - Images'.\n\n**Implementation**:\nCreate packages/web/src/pages/Images.tsx:\n1. List of cached images in table/card format\n2. Each row shows: reference, size, pulled date\n3. Delete button per image\n4. \"Pull Image\" button that opens dialog\n\nCreate packages/web/src/components/PullImageDialog.tsx:\n1. Input for image reference (e.g., ghcr.io/openfaasltd/slicer-systemd:latest)\n2. Submit triggers pull via API\n3. Show progress/status during pull\n4. Close and refresh on success\n\n**Mobile**: Stack image info vertically in cards.\n\n**Verification**:\n- Images list renders\n- Can pull new image\n- Can delete image\n- Loading states work\n\n**Tests**: Component tests for image list rendering","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:51:21.914Z","updated_at":"2026-01-30T03:51:46.560Z","started_at":null,"completed_at":null,"blockedBy":["kgm3jsw5","t6hjkcj3"],"blocks":[],"children":[]}
{"id":"i6bpqkir","parent_id":"2ogyez16","name":"Add VM exec endpoint","description":"Implement the command execution endpoint.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - VMs' (POST /api/vms/:id/exec).\n\n**Implementation**:\nAdd to packages/api/src/routes/vms.ts:\n\nPOST /api/vms/:id/exec:\n- Request body: { command: string, args?: string[] }\n- Response: { stdout: string, stderr: string, exitCode: number }\n\n1. Get VM from DB, verify status is 'running'\n2. Call AgentClient.exec(vmIp, command, args)\n3. Return result\n\nAdd timeout handling (default 30s, configurable via query param?).\nStream output if supported by agent.\n\n**Verification**:\n- Executes command and returns output\n- Returns correct exit code\n- Handles command timeout\n- Returns 400 for missing command\n\n**Tests**: Integration tests with mocked AgentClient","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:49:48.824Z","updated_at":"2026-01-30T03:50:10.172Z","started_at":null,"completed_at":null,"blockedBy":["o50py7s5"],"blocks":[],"children":[]}
{"id":"jgyl8pew","parent_id":null,"name":"Phase 6: Deployment & Polish","description":"Parent task for Docker deployment, documentation, and final testing.\n\n**Root Plan Reference**: See PLAN.md sections:\n- Docker Compose\n- Testing Strategy (E2E tests)\n- Setup Script\n\n**Prerequisites**: All previous phases substantially complete.\n\n**Completion Criteria**: All subtasks complete - Docker deployment works, E2E tests pass, documentation is complete.","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:07.778Z","updated_at":"2026-01-30T03:53:55.703Z","started_at":null,"completed_at":null,"blockedBy":["2ogyez16","oiub445r","epo976bv"],"blocks":[],"children":["txsoqbht","v7pn8xm6","w56hku3s","ssq7067i","z2xivjzk","w2y4zqk2"]}
{"id":"k0evvytc","parent_id":"2ogyez16","name":"Add VM health check endpoint","description":"Implement the health check endpoint that proxies to guest agent.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - VMs' (GET /api/vms/:id/health).\n\n**Implementation**:\nAdd to packages/api/src/routes/vms.ts:\n\nGET /api/vms/:id/health:\n1. Get VM from DB, verify status is 'running'\n2. Get VM's IP address\n3. Call AgentClient.checkHealth(vmIp)\n4. Return { healthy: boolean, checkedAt: timestamp }\n\nHandle case where VM is running but agent not yet ready (return healthy: false).\n\n**Verification**:\n- Returns healthy: true when agent responds\n- Returns healthy: false when agent unreachable\n- Returns 404 if VM not found\n- Returns 400 if VM not running\n\n**Tests**: Integration tests with mocked AgentClient","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:49:42.792Z","updated_at":"2026-01-30T03:50:09.858Z","started_at":null,"completed_at":null,"blockedBy":["o50py7s5","nuaw58y3"],"blocks":[],"children":[]}
{"id":"kgm3jsw5","parent_id":"oiub445r","name":"Create responsive layout shell","description":"Create the app's main layout with responsive navigation.\n\n**Root Plan Reference**: See PLAN.md section 'Mobile Responsiveness Requirements'.\n\n**Skills to Load**:\n- vercel-react-best-practices\n- vercel-composition-patterns\n\n**Implementation**:\nCreate packages/web/src/components/Layout.tsx:\n1. Desktop: Sidebar navigation with logo, nav links, user menu\n2. Mobile: Hamburger menu that opens full-screen nav overlay\n3. Main content area with proper padding\n4. Use shadcn Sheet component for mobile menu\n\nNavigation links:\n- Dashboard (/)\n- Images (/images)\n- Settings (/settings) - placeholder\n\n**Mobile Requirements**:\n- Touch-friendly nav items (min 44px tap targets)\n- Menu closes on navigation\n- Smooth transitions\n\n**Verification**:\n- Layout renders on desktop (1024px+)\n- Mobile menu works at 375px\n- Navigation links work\n\n**Tests**: Component tests for Layout rendering","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:44.381Z","updated_at":"2026-01-30T03:51:35.526Z","started_at":null,"completed_at":null,"blockedBy":["1wgbromu"],"blocks":["godpn1v3","g32ltrky","i0sygiuz"],"children":[]}
{"id":"kx70pb7q","parent_id":"epo976bv","name":"Add Image API endpoints","description":"Implement REST endpoints for image management.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - Images'.\n\n**Implementation**:\nAdd packages/api/src/routes/images.ts:\n\nGET /api/images:\n- List all cached images from database\n- Return array of Image objects\n\nPOST /api/images/pull:\n- Request: { reference: string }\n- Call RegistryService.pullImage()\n- Insert into database\n- Return new Image object\n- Consider: SSE for progress updates?\n\nDELETE /api/images/:id:\n- Verify no VMs are using this image\n- Call RegistryService.deleteImage()\n- Remove from database\n- Return { success: true }\n\n**Verification**:\n- List returns cached images\n- Pull downloads and caches image\n- Delete removes image\n- Cannot delete image in use\n\n**Tests**: Integration tests with mocked RegistryService","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:15.411Z","updated_at":"2026-01-30T03:52:51.021Z","started_at":null,"completed_at":null,"blockedBy":["rug8l1do","8y8f9afg"],"blocks":["30peita1","wjdenygd"],"children":[]}
{"id":"kzmbplbq","parent_id":"oiub445r","name":"Implement CreateVM dialog","description":"Create the dialog/drawer for creating new VMs.\n\n**Root Plan Reference**: See PLAN.md section 'Components - CreateVMDialog'.\n\n**Implementation**:\nCreate packages/web/src/components/CreateVMDialog.tsx:\n1. Use shadcn Dialog on desktop, Drawer on mobile (detect with media query)\n2. Form fields:\n   - Name (text, required)\n   - vCPUs (number, default 1)\n   - Memory MiB (number, default 512)\n   - Image (select dropdown, populated from /api/images)\n3. Submit creates VM via API\n4. Show loading state during creation\n5. Close and refresh list on success\n6. Show error on failure\n\n**Mobile**: Drawer slides up from bottom, full-width form.\n\n**Verification**:\n- Dialog opens from Dashboard\n- Form validates required fields\n- Creates VM successfully\n- Handles errors gracefully\n\n**Tests**: Component tests for form validation and submission","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:51:05.452Z","updated_at":"2026-01-30T03:51:45.342Z","started_at":null,"completed_at":null,"blockedBy":["g32ltrky"],"blocks":[],"children":[]}
{"id":"lv52wsii","parent_id":null,"name":"Phase 1: Foundation","description":"Parent task for all foundation work. Sets up the monorepo structure, tooling, database, and authentication.\n\n**Root Plan Reference**: See PLAN.md sections:\n- Monorepo Structure\n- Database Schema  \n- Tech Stack table\n\n**Completion Criteria**: All subtasks complete - monorepo initialized with all 4 packages, Turborepo configured, Drizzle schema created and migrated, Hono API running with health endpoint, Better Auth integrated.","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:46:48.028Z","updated_at":"2026-01-30T03:46:48.028Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":["vqokg46b","oiub445r","epo976bv"],"children":["hbbcj14o","ts9kuutu","t45jd3oh","tq3nqjx2","u9wc8vey","mt1g0hdi","8y8f9afg"]}
{"id":"m728c9xj","parent_id":"vqokg46b","name":"Create VM CRUD API endpoints","description":"Implement REST endpoints for VM create, read, update, delete operations.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - VMs'.\n\n**Implementation**:\nCreate packages/api/src/routes/vms.ts:\n1. GET /api/vms - List all VMs from database\n2. POST /api/vms - Create VM record (status: 'creating')\n   - Validate: name, vcpus, memoryMib, imageId\n   - Generate UUID\n   - Insert into database\n3. GET /api/vms/:id - Get single VM details\n4. DELETE /api/vms/:id - Delete VM record\n   - Must stop VM first if running\n   - Clean up network resources\n\nUse Zod schemas for validation (ties into OpenAPI).\nAdd auth middleware to protect all routes.\n\n**Verification**:\n- All endpoints return correct status codes\n- Validation rejects bad input\n- Auth required for all endpoints\n\n**Tests**: Integration tests (packages/api/src/routes/vms.integration.test.ts)\n- CRUD operations work\n- Validation errors return 400\n- Not found returns 404\n- Duplicate name returns 409","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:41.599Z","updated_at":"2026-01-30T03:49:11.408Z","started_at":null,"completed_at":null,"blockedBy":["tq3nqjx2","8y8f9afg"],"blocks":["nuaw58y3"],"children":[]}
{"id":"mpkto56o","parent_id":"vqokg46b","name":"Write setup script for host preparation","description":"Create the setup script that prepares a Linux host to run Bonfire.\n\n**Root Plan Reference**: See PLAN.md section 'Setup Script' for full bash script.\n\n**Implementation**:\nCreate scripts/setup.sh:\n1. Check for /dev/kvm (exit if not present)\n2. Download and install Firecracker binary (v1.14.1 or latest)\n3. Create bridge network 'bonfire0' with 10.0.100.1/24\n4. Enable IP forwarding (sysctl net.ipv4.ip_forward=1)\n5. Add NAT rule for VM internet access\n6. Create directories /var/lib/bonfire/{images,vms}\n7. Set permissions\n\nMake script idempotent (can run multiple times safely).\n\n**Verification**:\n- Script runs without error on Linux with KVM\n- Bridge exists after running\n- Firecracker binary is executable\n\n**Tests**: None (system script, tested manually or in E2E)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:57.552Z","updated_at":"2026-01-30T03:54:47.298Z","started_at":null,"completed_at":null,"blockedBy":["hbbcj14o"],"blocks":[],"children":[]}
{"id":"mt1g0hdi","parent_id":"lv52wsii","name":"Integrate Better Auth (email/password)","description":"Add authentication to the API using Better Auth with email/password strategy.\n\n**Root Plan Reference**: See PLAN.md section 'Auth (/api/auth/*)' and 'Database Schema' note about Better Auth tables.\n\n**Implementation**:\n1. Install better-auth in packages/api\n2. Create packages/api/src/lib/auth.ts:\n   - Configure Better Auth with SQLite adapter\n   - Enable email/password authentication\n   - Set up session management\n3. Mount Better Auth routes at /api/auth/*\n4. Create auth middleware for protected routes\n5. Add BETTER_AUTH_SECRET to config (env variable)\n\n**Fetch Docs Before Starting**:\n- Better Auth setup: https://www.better-auth.com/docs/installation\n- Better Auth email/password: https://www.better-auth.com/docs/authentication/email-password\n\n**Verification**:\n- POST /api/auth/sign-up creates user\n- POST /api/auth/sign-in returns session\n- Protected routes require valid session\n\n**Tests**:\n- Integration test for auth flow (sign-up, sign-in, sign-out)\n- packages/api/src/routes/auth.integration.test.ts","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:47:30.807Z","updated_at":"2026-01-30T03:47:49.659Z","started_at":null,"completed_at":null,"blockedBy":["u9wc8vey"],"blocks":["godpn1v3"],"children":[]}
{"id":"nuaw58y3","parent_id":"vqokg46b","name":"Create VM lifecycle endpoints (start/stop)","description":"Implement VM start and stop action endpoints.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - VMs' (start/stop actions).\n\n**Implementation**:\nAdd to packages/api/src/routes/vms.ts:\n\nPOST /api/vms/:id/start:\n1. Get VM from DB, verify status is 'stopped' or 'creating'\n2. Call NetworkService.createTap() - get TAP device, MAC\n3. Call NetworkService.allocateIP() - get IP address\n4. Call FirecrackerService.spawnFirecracker()\n5. Call FirecrackerService.configureVM() with all settings\n6. Call FirecrackerService.startVM()\n7. Update DB: status='running', pid, socketPath, tapDevice, macAddress, ipAddress\n8. Return updated VM\n\nPOST /api/vms/:id/stop:\n1. Get VM from DB, verify status is 'running'\n2. Call FirecrackerService.stopVM()\n3. Call NetworkService.deleteTap()\n4. Call NetworkService.releaseIP()\n5. Update DB: status='stopped', clear runtime fields\n6. Return updated VM\n\n**Verification**:\n- Start transitions creating/stopped -> running\n- Stop transitions running -> stopped\n- Resources allocated and cleaned up\n\n**Tests**: Integration tests with mocked services","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:49.582Z","updated_at":"2026-01-30T03:49:15.726Z","started_at":null,"completed_at":null,"blockedBy":["m728c9xj","t2qv6cbk","byyhjd7g"],"blocks":["k0evvytc","o50py7s5"],"children":[]}
{"id":"o50py7s5","parent_id":"2ogyez16","name":"Implement Agent service - HTTP client","description":"Create the Agent service HTTP client for communicating with guest agents.\n\n**Root Plan Reference**: See PLAN.md section 'Agent Service'.\n\n**Fetch Docs Before Starting**:\n- Slicer agent API: https://docs.slicervm.com/reference/api\n\n**Implementation**:\nCreate packages/api/src/services/agent/client.ts:\n1. AgentClient class that takes VM IP address\n2. checkHealth(): GET /health - returns boolean\n3. exec(command, args): POST /exec - returns { stdout, stderr, exitCode }\n4. upload(localPath, remotePath): POST /upload with multipart\n5. download(remotePath): GET /download?path= - returns Buffer\n\nHandle connection timeouts and errors gracefully.\nAgent typically listens on port 8080 (verify in Slicer docs).\n\n**Verification**:\n- Client methods have correct signatures\n- Error handling for network failures\n- Timeout handling\n\n**Tests**: Unit tests with mocked HTTP (packages/api/src/services/agent/client.test.ts)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:49:36.939Z","updated_at":"2026-01-30T03:54:47.659Z","started_at":null,"completed_at":null,"blockedBy":["nuaw58y3"],"blocks":["k0evvytc","i6bpqkir","uip4muxr","64tnrqyj"],"children":[]}
{"id":"oiub445r","parent_id":null,"name":"Phase 4: Web UI","description":"Parent task for the React web application. Mobile-responsive UI with terminal access.\n\n**Root Plan Reference**: See PLAN.md sections:\n- Web UI Pages & Components\n- Mobile Responsiveness Requirements\n- Tech Stack (React + Vite, shadcn/ui, ghostty-web, PartySocket)\n\n**Prerequisites**: Phase 3 should be complete for full functionality, but can start after Phase 1.\n\n**Completion Criteria**: All subtasks complete - fully functional web UI with login, dashboard, VM management, and terminal access. Works on mobile (375px viewport).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:50:22.515Z","updated_at":"2026-01-30T03:51:34.633Z","started_at":null,"completed_at":null,"blockedBy":["lv52wsii"],"blocks":["jgyl8pew"],"children":["6yvex719","1wgbromu","kgm3jsw5","godpn1v3","g32ltrky","kzmbplbq","fjb9xwa6","i0sygiuz","t6hjkcj3"]}
{"id":"rug8l1do","parent_id":"epo976bv","name":"Implement Registry service for OCI image pull","description":"Create the service that pulls OCI images (kernel + rootfs) from registries.\n\n**Root Plan Reference**: See PLAN.md section 'Registry Service'.\n\n**Fetch Docs Before Starting**:\n- OCI Distribution Spec: https://github.com/opencontainers/distribution-spec\n- Slicer images: https://docs.slicervm.com/reference/images\n\n**Implementation**:\nCreate packages/api/src/services/registry.ts:\n1. pullImage(reference): \n   - Parse reference (registry/repo:tag)\n   - Authenticate with registry if needed\n   - Pull manifest\n   - Download layers (kernel, rootfs)\n   - Extract to /var/lib/bonfire/images/<id>/\n   - Return image metadata\n2. deleteImage(imageId):\n   - Remove files from disk\n   - Clean up database record\n\nHandle progress reporting for large downloads.\nSupport ghcr.io (GitHub Container Registry).\n\n**Verification**:\n- Can pull Slicer public image\n- Files extracted correctly\n- Database updated\n\n**Tests**: Unit tests for reference parsing, integration tests for actual pull (requires network)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:08.877Z","updated_at":"2026-01-30T03:52:50.439Z","started_at":null,"completed_at":null,"blockedBy":["tq3nqjx2"],"blocks":["kx70pb7q"],"children":[]}
{"id":"ssq7067i","parent_id":"jgyl8pew","name":"Write E2E tests","description":"Create end-to-end tests that test the full VM lifecycle.\n\n**Root Plan Reference**: See PLAN.md section 'Testing Strategy - End-to-End Tests'.\n\n**Implementation**:\nCreate e2e/vm-lifecycle.test.ts:\n1. Create VM, start it, wait for agent healthy\n2. Execute command via exec endpoint\n3. Copy file to VM and back\n4. Stop VM, verify stopped\n5. Delete VM, verify deleted\n6. Cleanup in afterAll\n\nCreate e2e/terminal.test.ts:\n1. Create and start VM\n2. Connect WebSocket terminal\n3. Send commands, verify output\n4. Test reconnection\n5. Cleanup\n\nBoth tests:\n- Use @bonfire/sdk client\n- 60s timeout per test\n- Thorough cleanup to avoid leaked VMs\n\n**Requirements**:\n- Linux host with KVM\n- Run inside e2e.Dockerfile container\n\n**Verification**:\n- Tests pass in E2E container\n- No leaked resources after test run\n\n**Tests**: These ARE the E2E tests","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:38.040Z","updated_at":"2026-01-30T03:54:01.082Z","started_at":null,"completed_at":null,"blockedBy":["w56hku3s","30peita1"],"blocks":["w2y4zqk2"],"children":[]}
{"id":"t2qv6cbk","parent_id":"vqokg46b","name":"Implement Firecracker service - process management","description":"Create Firecracker process spawning and lifecycle management.\n\n**Root Plan Reference**: See PLAN.md section 'Firecracker Service'.\n\n**Fetch Docs Before Starting**:\n- Firecracker API spec: https://github.com/firecracker-microvm/firecracker/blob/main/src/firecracker/swagger/firecracker.yaml\n\n**Implementation**:\nCreate packages/api/src/services/firecracker/process.ts:\n1. spawnFirecracker(vmId): Spawns firecracker process with --api-sock, returns { pid, socketPath }\n2. configureVM(socketPath, configs): PUTs config to socket (machine-config, boot-source, drives, network-interfaces)\n3. startVM(socketPath): PUT /actions with InstanceStart\n4. stopVM(socketPath, pid): Graceful shutdown via API, then SIGTERM\n\nCreate packages/api/src/services/firecracker/socket-client.ts:\n- HTTP client that talks to Unix socket (Firecracker API)\n\n**Verification**:\n- Process spawns (requires firecracker binary)\n- Socket client sends correct HTTP requests\n\n**Tests**: \n- Unit tests mock child_process and socket\n- Integration tests require Firecracker binary","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:32.721Z","updated_at":"2026-01-30T03:49:10.819Z","started_at":null,"completed_at":null,"blockedBy":["f2ezlz9s"],"blocks":["nuaw58y3"],"children":[]}
{"id":"t44hfjxh","parent_id":"vqokg46b","name":"Implement Network service - IP pool management","description":"Create the network service's IP allocation logic (pure functions, no system calls).\n\n**Root Plan Reference**: See PLAN.md section 'Network Service' and 'Default Configuration'.\n\n**Implementation**:\nCreate packages/api/src/services/network/ip-pool.ts:\n1. IPPool class managing IP range 10.0.100.2 - 10.0.100.254\n2. allocate(): Returns next available IP, throws if exhausted\n3. release(ip): Returns IP to pool\n4. isAllocated(ip): Check if IP is in use\n5. MAC address generation function (deterministic from VM ID)\n\n**Why separate**: This is pure logic that can be fully unit tested without mocking system calls.\n\n**Verification**:\n- All unit tests pass\n- IP allocation is deterministic and trackable\n\n**Tests**: Unit tests (packages/api/src/services/network/ip-pool.test.ts)\n- Allocates sequential IPs starting at .2\n- Throws on pool exhaustion\n- Released IPs can be reallocated\n- MAC generation is deterministic","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:10.339Z","updated_at":"2026-01-30T03:54:46.704Z","started_at":null,"completed_at":null,"blockedBy":["t45jd3oh"],"blocks":["byyhjd7g"],"children":[]}
{"id":"t45jd3oh","parent_id":"lv52wsii","name":"Create package skeletons (api, web, sdk, cli)","description":"Create the basic package structure for all 4 packages with proper TypeScript configuration.\n\n**Root Plan Reference**: See PLAN.md section 'Monorepo Structure' for each package's structure.\n\n**Implementation**:\nFor each package (api, web, sdk, cli):\n1. Create package.json with name @bonfire/<package>\n2. Create tsconfig.json extending root config\n3. Create src/index.ts with placeholder export\n4. Add build/test scripts to package.json\n\n**Package-specific notes**:\n- api: Will use Hono, entry point src/index.ts\n- web: Will use Vite+React, entry point src/main.tsx (placeholder for now)\n- sdk: Pure TypeScript, entry point src/index.ts\n- cli: Will use Clack, entry point src/index.ts with bin field\n\n**Verification**:\n- Each package has package.json, tsconfig.json, src/index.ts\n- `bun install` still works\n- TypeScript compiles without errors\n\n**Tests**: None required (scaffolding only)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:47:09.420Z","updated_at":"2026-01-30T03:47:42.144Z","started_at":null,"completed_at":null,"blockedBy":["hbbcj14o","ts9kuutu"],"blocks":["tq3nqjx2","u9wc8vey","6yvex719","t44hfjxh","f2ezlz9s"],"children":[]}
{"id":"t6hjkcj3","parent_id":"oiub445r","name":"Create API client for web","description":"Create the API client used by the web frontend.\n\n**Root Plan Reference**: See PLAN.md section 'Monorepo Structure' (packages/web/src/lib/api.ts).\n\n**Implementation**:\nCreate packages/web/src/lib/api.ts:\n1. Base fetch wrapper with:\n   - Automatic JSON parsing\n   - Error handling\n   - Auth header injection\n   - Base URL configuration\n2. VM endpoints: list, get, create, delete, start, stop\n3. Image endpoints: list, pull, delete\n4. Type definitions matching API responses\n\nConsider: Could import from @bonfire/sdk once it's built, but for now create minimal client.\n\n**Verification**:\n- API calls work from frontend\n- Errors are properly thrown\n- Types match API responses\n\n**Tests**: Unit tests for error handling logic","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:51:28.296Z","updated_at":"2026-01-30T03:51:35.813Z","started_at":null,"completed_at":null,"blockedBy":["6yvex719"],"blocks":["godpn1v3","g32ltrky","i0sygiuz"],"children":[]}
{"id":"tq3nqjx2","parent_id":"lv52wsii","name":"Set up Drizzle with SQLite and create schema","description":"Initialize Drizzle ORM with SQLite in the api package and create the database schema.\n\n**Root Plan Reference**: See PLAN.md section 'Database Schema' for full schema definition.\n\n**Implementation**:\n1. Install drizzle-orm and drizzle-kit in packages/api\n2. Create packages/api/src/db/schema.ts with:\n   - vms table (id, name, status, vcpus, memoryMib, imageId, pid, socketPath, tapDevice, macAddress, ipAddress, createdAt, updatedAt)\n   - images table (id, reference, kernelPath, rootfsPath, sizeBytes, pulledAt)\n3. Create packages/api/src/db/index.ts for DB connection\n4. Create drizzle.config.ts for migrations\n5. Add migration scripts to package.json\n\n**Fetch Docs Before Starting**:\n- Drizzle SQLite: https://orm.drizzle.team/docs/get-started-sqlite\n\n**Verification**:\n- Schema file compiles without TypeScript errors\n- `bun run db:generate` creates migration files\n- `bun run db:push` applies schema to test DB\n\n**Tests**: Unit tests for schema validation (type checks)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:47:17.195Z","updated_at":"2026-01-30T03:47:45.684Z","started_at":null,"completed_at":null,"blockedBy":["t45jd3oh"],"blocks":["u9wc8vey","m728c9xj","8umd2ulb","rug8l1do"],"children":[]}
{"id":"ts9kuutu","parent_id":"lv52wsii","name":"Configure Turborepo for build orchestration","description":"Set up Turborepo for task orchestration across the monorepo.\n\n**Root Plan Reference**: See PLAN.md section 'Monorepo Structure' (turbo.json entry).\n\n**Implementation**:\n1. Install turbo as a dev dependency at root\n2. Create turbo.json with pipeline configuration:\n   - build: depends on ^build, outputs dist/**\n   - test: depends on ^build\n   - lint: no dependencies\n   - dev: persistent, no cache\n3. Add root scripts: build, test, lint, dev\n\n**Fetch Docs Before Starting**:\n- Load 'turborepo' skill for best practices\n- Turborepo docs: https://turbo.build/repo/docs\n\n**CRITICAL**: Create PACKAGE tasks not root tasks. Use 'turbo run' not shorthand.\n\n**Verification**:\n- `bunx turbo run build` runs (may have no output yet)\n- `bunx turbo run test` runs\n- turbo.json validates\n\n**Tests**: None required (configuration only)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:47:02.665Z","updated_at":"2026-01-30T03:47:41.588Z","started_at":null,"completed_at":null,"blockedBy":["hbbcj14o"],"blocks":["t45jd3oh"],"children":[]}
{"id":"txsoqbht","parent_id":"jgyl8pew","name":"Create Dockerfile for production","description":"Create the production Docker image for Bonfire.\n\n**Root Plan Reference**: See PLAN.md section 'Docker Compose'.\n\n**Implementation**:\nCreate docker/Dockerfile:\n1. Multi-stage build:\n   - Build stage: Install deps, build all packages\n   - Runtime stage: Minimal image with just built artifacts\n2. Use Bun as runtime\n3. Copy built API and Web packages\n4. Expose port 3000\n5. Set proper NODE_ENV=production\n6. Health check endpoint\n\nConsider:\n- Static web assets served by API or separate nginx?\n- Firecracker binary inclusion vs. host mount?\n\n**Verification**:\n- Image builds successfully\n- Container starts and responds to health check\n- API and Web UI accessible\n\n**Tests**: None (tested via E2E)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:15.313Z","updated_at":"2026-01-30T03:54:47.971Z","started_at":null,"completed_at":null,"blockedBy":["u9wc8vey"],"blocks":["v7pn8xm6"],"children":[]}
{"id":"u9wc8vey","parent_id":"lv52wsii","name":"Create Hono app with health endpoint","description":"Set up the Hono web framework in the api package with a basic health check endpoint.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints' and 'Monorepo Structure' (packages/api).\n\n**Implementation**:\n1. Install hono in packages/api\n2. Create packages/api/src/index.ts:\n   - Initialize Hono app\n   - Add GET /health endpoint returning { status: 'ok' }\n   - Export app and add Bun.serve for standalone running\n3. Add 'dev' script to run with --hot reload\n4. Create packages/api/src/lib/config.ts for app configuration (port, db path, etc.)\n\n**Fetch Docs Before Starting**:\n- Hono getting started: https://hono.dev/docs/getting-started/bun\n\n**Verification**:\n- `bun run dev` starts server in packages/api\n- GET http://localhost:3000/health returns 200 with { status: 'ok' }\n\n**Tests**: \n- Unit test for health endpoint using Hono's test client\n- packages/api/src/routes/health.test.ts","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:47:24.243Z","updated_at":"2026-01-30T03:47:46.240Z","started_at":null,"completed_at":null,"blockedBy":["t45jd3oh","tq3nqjx2"],"blocks":["mt1g0hdi","8y8f9afg","8umd2ulb","txsoqbht"],"children":[]}
{"id":"uip4muxr","parent_id":"2ogyez16","name":"Add VM file copy endpoints","description":"Implement file copy (upload/download) endpoints.\n\n**Root Plan Reference**: See PLAN.md section 'API Endpoints - VMs' (POST/GET /api/vms/:id/cp).\n\n**Implementation**:\nAdd to packages/api/src/routes/vms.ts:\n\nPOST /api/vms/:id/cp (upload to VM):\n- Content-Type: multipart/form-data\n- Fields: file (binary), path (destination path in VM)\n- Call AgentClient.upload()\n- Return { success: true, path: remotePath }\n\nGET /api/vms/:id/cp (download from VM):\n- Query param: path (source path in VM)\n- Call AgentClient.download()\n- Return binary file with appropriate Content-Type\n\nHandle large files with streaming if agent supports it.\n\n**Verification**:\n- Can upload file to VM\n- Can download file from VM\n- Returns 404 if remote path not found\n- Handles binary files correctly\n\n**Tests**: Integration tests with mocked AgentClient","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:49:55.313Z","updated_at":"2026-01-30T03:50:10.480Z","started_at":null,"completed_at":null,"blockedBy":["o50py7s5"],"blocks":[],"children":[]}
{"id":"v7pn8xm6","parent_id":"jgyl8pew","name":"Create Docker Compose stack","description":"Create the Docker Compose configuration for running Bonfire.\n\n**Root Plan Reference**: See PLAN.md section 'Docker Compose' for full compose file.\n\n**Implementation**:\nCreate docker/docker-compose.yml:\n1. bonfire service:\n   - Build from Dockerfile\n   - Ports: 3000 (API), 5173 (Web dev)\n   - Volumes: bonfire-data, /dev/kvm mount\n   - Privileged or NET_ADMIN + SYS_ADMIN caps\n   - Environment: DATABASE_URL, BETTER_AUTH_SECRET\n2. Named volumes for persistence\n\nCreate docker/docker-compose.dev.yml:\n- Development overrides (hot reload, source mounts)\n\n**Verification**:\n- `docker compose up` starts Bonfire\n- Web UI accessible at localhost:5173\n- API accessible at localhost:3000\n- Data persists across restarts\n\n**Tests**: None (tested via E2E)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:21.945Z","updated_at":"2026-01-30T03:54:00.119Z","started_at":null,"completed_at":null,"blockedBy":["txsoqbht"],"blocks":[],"children":[]}
{"id":"vqokg46b","parent_id":null,"name":"Phase 2: VM Management Core","description":"Parent task for VM management implementation. Implements Firecracker and Network services, VM CRUD, and lifecycle management.\n\n**Root Plan Reference**: See PLAN.md sections:\n- Services Implementation (Firecracker Service, Network Service)\n- API Endpoints (VMs section)\n- Setup Script\n\n**Prerequisites**: Phase 1 must be complete (API foundation ready).\n\n**Completion Criteria**: All subtasks complete - can create, start, stop, and delete VMs via API. Setup script works on Linux host.","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:48:02.545Z","updated_at":"2026-01-30T03:49:10.234Z","started_at":null,"completed_at":null,"blockedBy":["lv52wsii"],"blocks":["2ogyez16"],"children":["t44hfjxh","byyhjd7g","f2ezlz9s","t2qv6cbk","m728c9xj","nuaw58y3","mpkto56o","8umd2ulb"]}
{"id":"w2y4zqk2","parent_id":"jgyl8pew","name":"Final polish and bug fixes","description":"Address any remaining issues and polish the application.\n\n**Root Plan Reference**: PLAN.md Phase 6 - Bug fixes and polish.\n\n**Implementation**:\nThis is a catch-all task for:\n1. Fix any bugs discovered during E2E testing\n2. Improve error messages\n3. Add any missing loading states\n4. Ensure mobile responsiveness is complete\n5. Review and update README.md with:\n   - Quick start guide\n   - Development setup\n   - Architecture overview\n6. Add CONTRIBUTING.md if needed\n\n**Verification**:\n- All tests pass\n- App works smoothly on mobile\n- Documentation is complete\n- No console errors or warnings\n\n**Tests**: Manual verification and existing test suite","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:50.935Z","updated_at":"2026-01-30T03:54:01.680Z","started_at":null,"completed_at":null,"blockedBy":["ssq7067i"],"blocks":[],"children":[]}
{"id":"w56hku3s","parent_id":"jgyl8pew","name":"Create test Docker configurations","description":"Create Docker configurations for integration and E2E tests.\n\n**Root Plan Reference**: See PLAN.md section 'Testing Strategy - Test Infrastructure Files'.\n\n**Implementation**:\nCreate docker/test.Dockerfile:\n- For integration tests\n- No KVM needed, no special privileges\n- Runs with mocked services\n\nCreate docker/e2e.Dockerfile:\n- For E2E tests\n- Ubuntu base with Bun installed\n- Firecracker binary included\n- Network tools (iproute2, iptables)\n\nCreate docker/docker-compose.test.yml:\n- test-integration service (from test.Dockerfile)\n- test-e2e service (from e2e.Dockerfile)\n  - privileged, /dev/kvm mount, NET_ADMIN\n  - Separate bridge (bonfire-test0), subnet (10.0.200.0/24)\n\nCreate scripts/run-e2e.sh:\n- Set up test bridge\n- Run E2E tests\n- Clean up\n\n**Verification**:\n- Integration tests run in container\n- E2E container has access to KVM\n\n**Tests**: Meta-verification by running the test containers","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:30.118Z","updated_at":"2026-01-30T03:54:00.465Z","started_at":null,"completed_at":null,"blockedBy":["8umd2ulb"],"blocks":["ssq7067i","z2xivjzk"],"children":[]}
{"id":"wjdenygd","parent_id":"epo976bv","name":"Implement CLI - Image and login commands","description":"Implement image management and authentication commands.\n\n**Root Plan Reference**: See PLAN.md section 'CLI Commands - image subcommands, login'.\n\n**Implementation**:\nCreate packages/cli/src/commands/image.ts:\n\nbonfire image pull <reference>:\n- Pull image with progress indicator\n- Print success with image ID\n\nbonfire image list:\n- Table output of cached images\n- Columns: ID, Reference, Size, Pulled At\n\nbonfire image rm <id>:\n- Confirm deletion\n- Delete image\n\nCreate packages/cli/src/commands/login.ts:\n\nbonfire login:\n- Prompt for API URL if not configured\n- Prompt for email and password (Clack password input)\n- Call auth endpoint\n- Save token to config\n- Print success message\n\n**Verification**:\n- Can pull images from CLI\n- Can list and delete images\n- Login flow works end-to-end\n- Token persists for subsequent commands\n\n**Tests**: Unit tests for argument parsing, integration test for login flow","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:52:44.690Z","updated_at":"2026-01-30T03:52:56.136Z","started_at":null,"completed_at":null,"blockedBy":["718lsccm","kx70pb7q"],"blocks":[],"children":[]}
{"id":"z2xivjzk","parent_id":"jgyl8pew","name":"Create GitHub Actions CI workflow","description":"Set up CI/CD pipeline for automated testing.\n\n**Root Plan Reference**: See PLAN.md section 'Testing Strategy - CI Configuration'.\n\n**Implementation**:\nCreate .github/workflows/test.yml:\n\nJobs:\n1. unit:\n   - runs-on: ubuntu-latest\n   - Setup Bun\n   - Install deps\n   - Run `bun test` (unit tests only)\n\n2. integration:\n   - runs-on: ubuntu-latest\n   - Run docker compose test-integration\n\n3. e2e (optional, main branch only):\n   - runs-on: [self-hosted, kvm]\n   - Only on push to main\n   - Run docker compose test-e2e\n\n4. build:\n   - Build Docker image\n   - Push to ghcr.io on main branch tags\n\n**Verification**:\n- CI runs on PR\n- All test types execute\n- Build creates deployable image\n\n**Tests**: CI itself verifies correctness","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-01-30T03:53:45.057Z","updated_at":"2026-01-30T03:54:01.377Z","started_at":null,"completed_at":null,"blockedBy":["w56hku3s"],"blocks":[],"children":[]}
